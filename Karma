-- Скрипт для The Strongest Battlegrounds с основными функциями stable lock, alt lock, автофарм, автоблок

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local AimLockEnabled = false
local AltLockHold = false
local AutoFarmEnabled = false
local AutoBlockEnabled = false
local Target = nil

-- Функция нахождения ближайшей цели для прицеливания
local function GetClosestTarget()
    local closest
    local shortestDistance = math.huge
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local screenPos, onScreen = workspace.CurrentCamera:WorldToScreenPoint(player.Character.HumanoidRootPart.Position)
            if onScreen then
                local distance = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
                if distance < shortestDistance and distance < 150 then -- Радиус поиска цели 150 пикселей
                    closest = player
                    shortestDistance = distance
                end
            end
        end
    end
    return closest
end

-- Перемещение мыши на цель (требует экзекутор с поддержкой mousemoveabs)
local function AimAtTarget(target)
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local targetPos = target.Character.HumanoidRootPart.Position
        local screenPos = workspace.CurrentCamera:WorldToScreenPoint(targetPos)
        if screenPos.Z > 0 then
            mousemoveabs(screenPos.X, screenPos.Y)
        end
    end
end

-- Обработка нажатия клавиш
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F then
        AimLockEnabled = not AimLockEnabled
        print("AimLock " .. (AimLockEnabled and "включен" or "выключен"))
    elseif input.KeyCode == Enum.KeyCode.LeftAlt then
        AltLockHold = true
    elseif input.KeyCode == Enum.KeyCode.T then
        AutoFarmEnabled = not AutoFarmEnabled
        print("AutoFarm " .. (AutoFarmEnabled and "включен" or "выключен"))
    elseif input.KeyCode == Enum.KeyCode.B then
        AutoBlockEnabled = not AutoBlockEnabled
        print("AutoBlock " .. (AutoBlockEnabled and "включен" or "выключен"))
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.LeftAlt then
        AltLockHold = false
    end
end)

-- Основной игровой цикл скрипта
RunService.RenderStepped:Connect(function()
    if AimLockEnabled or AltLockHold then
        Target = GetClosestTarget()
        if Target then
            AimAtTarget(Target)
        end
    end

    if AutoFarmEnabled then
        local npcList = workspace.Enemies:GetChildren() -- Пример NPC для фарма, заменить на свои объекты
        for _, npc in pairs(npcList) do
            if npc:FindFirstChild("Humanoid") and npc.Humanoid.Health > 0 then
                -- Простая атака NPC (пример)
                LocalPlayer.Character.HumanoidRootPart.CFrame = npc.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                -- Триггер атаки (зависит от механики игры)
                fireclickdetector(npc.ClickDetector)
                wait(0.5)
            end
        end
    end

    if AutoBlockEnabled then
        -- Пример простого автоблока (физиологическая блокировка)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.GettingUp) -- Заглушка под блок
        end
    end
end)

print("Скрипт запущен. F - AimLock, Left Alt - Alt Lock, T - AutoFarm, B - AutoBlock")
