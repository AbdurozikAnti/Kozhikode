-- –ú–æ–±–∏–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –°–∏–ª—å–Ω–µ–π—à–∏–µ –ø–æ–ª—è –±–∏—Ç–≤—ã
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer

-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
local Config = {
    StableEnabled = false,
    LockEnabled = false,
    AltLockEnabled = false,
    Smoothness = 0.15,
    MaxDistance = 150
}

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
local Target = nil
local Buttons = {}

-- –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
function CreateMobileUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "BattleFieldMobileUI"
    ScreenGui.Parent = game:GetService("CoreGui")
    
    -- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 200, 0, 180)
    MainFrame.Position = UDim2.new(0, 20, 0.5, -90)
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    MainFrame.BackgroundTransparency = 0.3
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui
    
    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 30)
    Title.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    Title.Text = "üéØ –ü–æ–ª—è –ë–∏—Ç–≤—ã"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.TextSize = 14
    Title.Font = Enum.Font.GothamBold
    Title.Parent = MainFrame
    
    -- –ö–Ω–æ–ø–∫–∞ STABLE [M]
    local StableButton = Instance.new("TextButton")
    StableButton.Size = UDim2.new(0.9, 0, 0, 40)
    StableButton.Position = UDim2.new(0.05, 0, 0, 35)
    StableButton.BackgroundColor3 = Color3.fromRGB(70, 130, 200)
    StableButton.Text = "[M] STABLE"
    StableButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    StableButton.TextSize = 12
    StableButton.Font = Enum.Font.GothamBold
    StableButton.Parent = MainFrame
    
    -- –ö–Ω–æ–ø–∫–∞ LOCK [L]
    local LockButton = Instance.new("TextButton")
    LockButton.Size = UDim2.new(0.9, 0, 0, 40)
    LockButton.Position = UDim2.new(0.05, 0, 0, 80)
    LockButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    LockButton.Text = "[L] LOCK"
    LockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    LockButton.TextSize = 12
    LockButton.Font = Enum.Font.GothamBold
    LockButton.Parent = MainFrame
    
    -- –ö–Ω–æ–ø–∫–∞ ALT LOCK [P]
    local AltLockButton = Instance.new("TextButton")
    AltLockButton.Size = UDim2.new(0.9, 0, 0, 40)
    AltLockButton.Position = UDim2.new(0.05, 0, 0, 125)
    AltLockButton.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
    AltLockButton.Text = "[P] ALT LOCK"
    AltLockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    AltLockButton.TextSize = 12
    AltLockButton.Font = Enum.Font.GothamBold
    AltLockButton.Parent = MainFrame
    
    -- –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–Ω–æ–ø–∫–∏
    Buttons.Stable = StableButton
    Buttons.Lock = LockButton
    Buttons.AltLock = AltLockButton
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–∂–∞—Ç–∏–π
    StableButton.MouseButton1Click:Connect(function()
        Config.StableEnabled = not Config.StableEnabled
        StableButton.BackgroundColor3 = Config.StableEnabled and Color3.fromRGB(40, 100, 170) or Color3.fromRGB(70, 130, 200)
        print("üéØ STABLE: " .. (Config.StableEnabled and "–í–ö–õ" or "–í–´–ö–õ"))
    end)
    
    LockButton.MouseButton1Click:Connect(function()
        Config.LockEnabled = not Config.LockEnabled
        LockButton.BackgroundColor3 = Config.LockEnabled and Color3.fromRGB(170, 40, 40) or Color3.fromRGB(200, 60, 60)
        
        if Config.LockEnabled then
            Target = FindTarget()
            print("üîí LOCK: " .. (Target and "–¶–µ–ª—å: " .. Target.Name or "–¶–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"))
        else
            Target = nil
            print("üîì LOCK: –í—ã–∫–ª")
        end
    end)
    
    AltLockButton.MouseButton1Click:Connect(function()
        Config.AltLockEnabled = not Config.AltLockEnabled
        AltLockButton.BackgroundColor3 = Config.AltLockEnabled and Color3.fromRGB(40, 150, 60) or Color3.fromRGB(60, 180, 80)
        print("üéØ ALT LOCK: " .. (Config.AltLockEnabled and "–í–ö–õ" or "–í–´–ö–õ"))
    end)
    
    -- –î–µ–ª–∞–µ–º —Ñ—Ä–µ–π–º –ø–µ—Ä–µ–º–µ—â–∞–µ–º—ã–º
    MakeDraggable(Title)
    
    return ScreenGui
end

-- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
function MakeDraggable(frame)
    local dragging = false
    local dragInput
    local dragStart
    local startPos
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Parent.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Parent.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- –ü–æ–∏—Å–∫ —Ü–µ–ª–∏
function FindTarget()
    local closest = nil
    local closestDistance = Config.MaxDistance
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local character = player.Character
            local humanoid = character:FindFirstChild("Humanoid")
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            
            if humanoid and humanoid.Health > 0 and rootPart then
                local distance = (LocalPlayer.Character.HumanoidRootPart.Position - rootPart.Position).Magnitude
                
                if distance <= closestDistance then
                    closestDistance = distance
                    closest = player
                end
            end
        end
    end
    
    return closest
end

-- –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ
function StableAim()
    if not Config.StableEnabled or not Target then return end
    
    local targetChar = Target.Character
    if not targetChar then return end
    
    local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
    if not targetRoot then return end
    
    local camera = workspace.CurrentCamera
    
    -- –ü–ª–∞–≤–Ω–æ–µ –Ω–∞–≤–µ–¥–µ–Ω–∏–µ
    local currentCF = camera.CFrame
    local targetCF = CFrame.lookAt(camera.CFrame.Position, targetRoot.Position)
    local smoothedCF = currentCF:Lerp(targetCF, Config.Smoothness)
    
    camera.CFrame = smoothedCF
end

-- –û—Å–Ω–æ–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
function LockOn()
    if not Config.LockEnabled then return end
    
    if not Target then
        Target = FindTarget()
        return
    end
    
    local targetChar = Target.Character
    if not targetChar then
        Target = nil
        return
    end
    
    local humanoid = targetChar:FindFirstChild("Humanoid")
    local rootPart = targetChar:FindFirstChild("HumanoidRootPart")
    
    if not humanoid or humanoid.Health <= 0 or not rootPart then
        Target = nil
        return
    end
    
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
    local distance = (LocalPlayer.Character.HumanoidRootPart.Position - rootPart.Position).Magnitude
    if distance > Config.MaxDistance then
        Target = nil
        return
    end
    
    StableAim()
end

-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
function AltLock()
    if not Config.AltLockEnabled then return end
    
    local target = FindTarget()
    if target then
        local targetChar = target.Character
        if targetChar then
            local rootPart = targetChar:FindFirstChild("HumanoidRootPart")
            if rootPart then
                -- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
                local camera = workspace.CurrentCamera
                camera.CFrame = CFrame.lookAt(camera.CFrame.Position, rootPart.Position)
            end
        end
    end
end

-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞
function UpdateStatus()
    if Buttons.Lock then
        if Config.LockEnabled and Target then
            Buttons.Lock.Text = "[L] LOCK: " .. Target.Name
        else
            Buttons.Lock.Text = "[L] LOCK"
        end
    end
end

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
CreateMobileUI()

print("üì± –ú–æ–±–∏–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω!")
print("üéØ [M] STABLE - –ü–ª–∞–≤–Ω–æ–µ –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ")
print("üîí [L] LOCK - –ê–≤—Ç–æ-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞")
print("üéØ [P] ALT LOCK - –ë—ã—Å—Ç—Ä–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞")

-- –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª
RunService.RenderStepped:Connect(function()
    if Config.LockEnabled then
        LockOn()
    end
    
    if Config.AltLockEnabled then
        AltLock()
    end
    
    UpdateStatus()
end)

-- –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–∏ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
while true do
    wait(2)
    if Config.LockEnabled and Target then
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ü–µ–ª—å –µ—â–µ –∂–∏–≤–∞ –∏ –≤ —Ä–∞–¥–∏—É—Å–µ
        local targetChar = Target.Character
        if not targetChar then
            Target = FindTarget()
        else
            local humanoid = targetChar:FindFirstChild("Humanoid")
            local rootPart = targetChar:FindFirstChild("HumanoidRootPart")
            
            if not humanoid or humanoid.Health <= 0 or not rootPart then
                Target = FindTarget()
            else
                local distance = (LocalPlayer.Character.HumanoidRootPart.Position - rootPart.Position).Magnitude
                if distance > Config.MaxDistance then
                    Target = FindTarget()
                end
            end
        end
    end
end
