local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Murder Mystery 2 OP",
    LoadingTitle = "Murder Mystery 2",
    LoadingSubtitle = "OP чит by Assistant",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "MM2Scripts",
        FileName = "MM2Config"
    }
})

-- Категории
local CombatTab = Window:CreateTab("Combat")
local VisualsTab = Window:CreateTab("Visuals")
local AutomationTab = Window:CreateTab("Automation")
local MovementTab = Window:CreateTab("Movement")
local SettingsTab = Window:CreateTab("Settings")

-- Боевые (Combat)

local killAllToggle = CombatTab:CreateToggle({
    Name = "Kill All (Маньяк)",
    CurrentValue = false,
    Callback = function(value)
        if value then
            -- Автоматически атака всех (пример)
            while killAllToggle.CurrentValue do
                for _, player in pairs(game.Players:GetPlayers()) do
                    if player ~= game.Players.LocalPlayer then
                        -- Вставьте реализацию атаки тут (например, отправка события на сервер)
                    end
                end
                wait(0.5)
            end
        end
    end
})

local autoKillAuraToggle = CombatTab:CreateToggle({
    Name = "Auto-Kill Aura",
    CurrentValue = false,
    Callback = function(value)
        -- Логика атаки рядом стоящих игроков ножом
    end
})

local silentAimToggle = CombatTab:CreateToggle({
    Name = "Silent Aim / Aimbot",
    CurrentValue = false,
    Callback = function(value)
        -- Реализация прицела (пример, упрощённо)
    end
})

-- Визуальные (Visuals)

local ESPEnabled = false
local ESP = {}

VisualsTab:CreateToggle({
    Name = "Enable ESP",
    CurrentValue = false,
    Callback = function(value)
        ESPEnabled = value
        if value then
            spawn(function()
                while ESPEnabled do
                    for _, player in pairs(game.Players:GetPlayers()) do
                        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local color
                            -- Цвета по ролям
                            if player:GetAttribute("Role") == "Murderer" then
                                color = Color3.new(1,0,0) -- красный
                            elseif player:GetAttribute("Role") == "Sheriff" then
                                color = Color3.new(0,0,1) -- синий
                            else
                                color = Color3.new(0,1,0) -- зеленый
                            end
                            -- Создание/обновление ESP
                            if not ESP[player] then
                                ESP[player] = Drawing.new("Square")
                                ESP[player].Thickness = 2
                                ESP[player].Filled = false
                                ESP[player].Visible = true
                            end
                            local cam = workspace.CurrentCamera
                            local vec, onScreen = cam:WorldToViewportPoint(player.Character.HumanoidRootPart.Position)
                            if onScreen then
                                ESP[player].Position = Vector2.new(vec.X - 25, vec.Y - 25)
                                ESP[player].Size = Vector2.new(50, 50)
                                ESP[player].Color = color
                                ESP[player].Visible = true
                            else
                                ESP[player].Visible = false
                            end
                        elseif ESP[player] then
                            ESP[player].Visible = false
                        end
                    end
                    wait(0.03)
                end
                -- Удаляем ESP при выключении
                for _, box in pairs(ESP) do
                    box:Remove()
                end
                ESP = {}
            end)
        else
            -- Отключаем ESP
            for _, box in pairs(ESP) do
                box:Remove()
            end
            ESP = {}
        end
    end
})

-- Автоматизация (Automation)

AutomationTab:CreateToggle({
    Name = "Auto-Farm Монет и Мячей",
    CurrentValue = false,
    Callback = function(value)
        -- Пример автофарма валюты
    end
})

AutomationTab:CreateToggle({
    Name = "Anti-AFK",
    CurrentValue = false,
    Callback = function(value)
        -- Отключение кика за бездействие
    end
})

AutomationTab:CreateToggle({
    Name = "Auto Get Revolver (Шериф)",
    CurrentValue = false,
    Callback = function(value)
        -- Автоматический подбор револьвера
    end
})

-- Перемещение (Movement)

MovementTab:CreateToggle({
    Name = "Fly Toggle",
    CurrentValue = false,
    Callback = function(value)
        -- Флай логика
    end
})

MovementTab:CreateButton({
    Name = "Teleport to Gun",
    Callback = function()
        -- Телепорт к оружию на карте
    end
})

MovementTab:CreateSlider({
    Name = "Walkspeed",
    Range = {16, 100},
    Increment = 1,
    CurrentValue = 16,
    Callback = function(value)
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = value
    end
})

MovementTab:CreateSlider({
    Name = "Jump Power",
    Range = {50, 200},
    Increment = 1,
    CurrentValue = 50,
    Callback = function(value)
        game.Players.LocalPlayer.Character.Humanoid.JumpPower = value
    end
})

-- Прочие (Settings)

local themeDropdown = SettingsTab:CreateDropdown({
    Name = "Select Theme",
    Options = {"Default", "Serenity", "Ocean"},
    CurrentOption = "Default",
    Callback = function(theme)
        Rayfield:ChangeTheme(theme)
    end
})

return Window
