-- ‚ñà‚ñÄ‚ñÄ ‚ñà‚ñÄ‚ñÄ‚ñà ‚ñà‚ñÄ‚ñÄ‚ñÑ ‚ñà‚ñÄ‚ñÄ ‚ñÄ‚ñÄ‚ñà‚ñÄ‚ñÄ ‚ñà‚ñÄ‚ñÄ ‚ñà‚ñÄ‚ñÄ‚ñà ‚ñà‚ñÄ‚ñÄ‚ñÑ 
-- ‚ñà‚ñë‚ñë ‚ñà‚ñÑ‚ñÑ‚ñà ‚ñà‚ñÄ‚ñÄ‚ñÑ ‚ñà‚ñÄ‚ñÄ ‚ñë‚ñë‚ñà‚ñë‚ñë ‚ñà‚ñÄ‚ñÄ ‚ñà‚ñÑ‚ñÑ‚ñà ‚ñà‚ñÄ‚ñÄ‚ñÑ 
-- ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ‚ñë‚ñë‚ñÄ ‚ñÄ‚ñÄ‚ñÄ‚ñë ‚ñÄ‚ñÄ‚ñÄ ‚ñë‚ñë‚ñÄ‚ñë‚ñë ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ‚ñë‚ñë‚ñÄ ‚ñÄ‚ñÄ‚ñÄ‚ñë 
-- –î–û–†–ê–ë–û–¢–ê–ù–ù–´–ô ESP + –û–ë–´–ß–ù–´–ï –¢–†–ï–ô–°–ï–†–´ (–æ—Ç –≤–∞—Å –¥–æ –∏–≥—Ä–æ–∫–∞), –¢–ê–ô–ú–ï–†–´ –ò –ê–§–ö –£–ë–†–ê–ù–´

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local Window = Rayfield:CreateWindow({
    Name = "üî• MM2 ULTIMATE v6.1",
    LoadingTitle = "–ó–∞–≥—Ä—É–∑–∫–∞ ESP –∏ —Ç—Ä–µ–π—Å–µ—Ä—ã...",
    LoadingSubtitle = "–¢–∞–π–º–µ—Ä—ã –∏ –ê–§–ö —É–±—Ä–∞–Ω—ã",
    ConfigurationSaving = { Enabled = true },
    KeySystem = false
})

local CheatConfig = {
    ESP = {
        Enabled = false,
        Tracers = false,
        Colors = {
            Murderer = Color3.new(1, 0, 0),
            Sheriff = Color3.new(0, 0, 1),
            Innocent = Color3.new(0, 1, 0)
        }
    },
    Fly = {
        Enabled = false,
        Speed = 50
    }
}

local ESPObjects = {}
local TracerObjects = {}

-- üëÅÔ∏è ESP: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏
local function GetPlayerRole(player)
    if player.Character then
        for _, tool in ipairs(player.Backpack:GetChildren()) do
            if tool:IsA("Tool") then
                if string.lower(tool.Name):find("knife") then
                    return "Murderer"
                elseif string.lower(tool.Name):find("gun") then
                    return "Sheriff"
                end
            end
        end
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then
                if string.lower(tool.Name):find("knife") then
                    return "Murderer"
                elseif string.lower(tool.Name):find("gun") then
                    return "Sheriff"
                end
            end
        end
    end
    return "Innocent"
end

-- ESP –Ω–µ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç: —Å–ª—É—à–∞–µ–º –ø–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —É –∏–≥—Ä–æ–∫–æ–≤
local function RefreshPlayerESP(player)
    if player == LocalPlayer then return end
    if ESPObjects[player] then
        if ESPObjects[player].Highlight then ESPObjects[player].Highlight:Destroy() end
        if ESPObjects[player].Billboard then ESPObjects[player].Billboard:Destroy() end
        ESPObjects[player] = nil
    end
    if not player.Character or not player.Character:FindFirstChild("Head") then return end

    local highlight = Instance.new("Highlight")
    highlight.Name = player.Name .. "_ESP"
    highlight.Adornee = player.Character
    highlight.FillTransparency = 0.7
    highlight.OutlineTransparency = 0.3
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop

    local billboard = Instance.new("BillboardGui")
    billboard.Name = player.Name .. "_Info"
    billboard.Size = UDim2.new(0, 200, 0, 60)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.Adornee = player.Character.Head
    billboard.AlwaysOnTop = true

    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = player.Name
    textLabel.TextColor3 = Color3.new(1, 1, 1)
    textLabel.TextSize = 14
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextStrokeTransparency = 0.3
    textLabel.Parent = billboard

    billboard.Parent = player.Character.Head
    highlight.Parent = player.Character

    ESPObjects[player] = {
        Highlight = highlight,
        Billboard = billboard,
        TextLabel = textLabel
    }
end

local function UpdateESP()
    for player, espData in pairs(ESPObjects) do
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local role = GetPlayerRole(player)
            local color = CheatConfig.ESP.Colors[role]
            espData.Highlight.FillColor = color
            espData.Highlight.OutlineColor = color
            espData.TextLabel.TextColor3 = color
            espData.TextLabel.Text = player.Name .. " - " .. role
            espData.Highlight.Enabled = CheatConfig.ESP.Enabled
            espData.Billboard.Enabled = CheatConfig.ESP.Enabled
        else
            if espData.Highlight then espData.Highlight:Destroy() end
            if espData.Billboard then espData.Billboard:Destroy() end
            ESPObjects[player] = nil
        end
    end
end

local function SetupPlayerESP(player)
    player.CharacterAdded:Connect(function()
        wait(1)
        if CheatConfig.ESP.Enabled then
            RefreshPlayerESP(player)
        end
    end)
    if player.Character and CheatConfig.ESP.Enabled then
        RefreshPlayerESP(player)
    end
end

local function SetupAllESP()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            SetupPlayerESP(player)
        end
    end
    Players.PlayerAdded:Connect(function(player)
        SetupPlayerESP(player)
    end)
end

-- –¢—Ä–µ–π—Å–µ—Ä—ã: –æ–±—ã—á–Ω—ã–µ –ª–∏–Ω–∏–∏ –æ—Ç –≤–∞—Å –¥–æ –∏–≥—Ä–æ–∫–∞ (HumanoidRootPart ‚Üí HumanoidRootPart)
local function CreateTracer(player)
    if player == LocalPlayer then return end
    if TracerObjects[player] then return end

    local tracer = Instance.new("Part")
    tracer.Name = player.Name .. "_Tracer"
    tracer.Anchored = true
    tracer.CanCollide = false
    tracer.Material = Enum.Material.Neon
    tracer.Size = Vector3.new(0.1, 0.1, 0.1)
    tracer.Transparency = 0.5
    tracer.Parent = Workspace

    TracerObjects[player] = tracer
    return tracer
end

local function UpdateTracers()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return end
    local fromPos = LocalPlayer.Character.HumanoidRootPart.Position
    for player, tracer in pairs(TracerObjects) do
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local toPos = player.Character.HumanoidRootPart.Position
            local color = CheatConfig.ESP.Colors[GetPlayerRole(player)]
            tracer.BrickColor = BrickColor.new(color)
            tracer.Size = Vector3.new(0.1, 0.1, (fromPos - toPos).Magnitude)
            tracer.CFrame = CFrame.lookAt(fromPos, toPos) * CFrame.new(0, 0, -tracer.Size.Z/2)
            tracer.Transparency = CheatConfig.ESP.Tracers and 0.3 or 1
            tracer.Parent = Workspace
        else
            if tracer then tracer:Destroy() end
            TracerObjects[player] = nil
        end
    end
end

-- –ü–æ–ª–µ—Ç (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å)
local FlyConnection
local function ToggleFly()
    if CheatConfig.Fly.Enabled then
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Name = "FlyVelocity"
        bodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)
        bodyVelocity.Parent = LocalPlayer.Character.HumanoidRootPart

        FlyConnection = RunService.Heartbeat:Connect(function()
            if not CheatConfig.Fly.Enabled or not LocalPlayer.Character then
                bodyVelocity:Destroy()
                FlyConnection:Disconnect()
                return
            end

            local camera = Workspace.CurrentCamera
            local root = LocalPlayer.Character.HumanoidRootPart

            local direction = Vector3.new(0, 0, 0)
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.W) then
                direction = direction + camera.CFrame.LookVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.S) then
                direction = direction - camera.CFrame.LookVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.A) then
                direction = direction - camera.CFrame.RightVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.D) then
                direction = direction + camera.CFrame.RightVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.Space) then
                direction = direction + Vector3.new(0, 1, 0)
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.LeftShift) then
                direction = direction + Vector3.new(0, -1, 0)
            end

            bodyVelocity.Velocity = direction * CheatConfig.Fly.Speed
        end)
    else
        if FlyConnection then
            FlyConnection:Disconnect()
        end
        local velocity = LocalPlayer.Character.HumanoidRootPart:FindFirstChild("FlyVelocity")
        if velocity then
            velocity:Destroy()
        end
    end
end

-- UI
local MainTab = Window:CreateTab("üî• –ì–ª–∞–≤–Ω–∞—è", 4483362458)
local ESPSection = MainTab:CreateSection("üëÅÔ∏è –£–ª—É—á—à–µ–Ω–Ω—ã–π ESP")

MainTab:CreateToggle({
    Name = "üéØ –í–∫–ª—é—á–∏—Ç—å ESP (—Ü–≤–µ—Ç–∞ –ø–æ —Ä–æ–ª—è–º)",
    CurrentValue = false,
    Callback = function(Value)
        CheatConfig.ESP.Enabled = Value
        if not Value then
            for player, espData in pairs(ESPObjects) do
                if espData.Highlight then espData.Highlight:Destroy() end
                if espData.Billboard then espData.Billboard:Destroy() end
            end
            ESPObjects = {}
        else
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LocalPlayer then
                    RefreshPlayerESP(player)
                end
            end
        end
    end
})

MainTab:CreateToggle({
    Name = "üìè –¢—Ä–µ–π—Å–µ—Ä—ã –∫ –∏–≥—Ä–æ–∫–∞–º (–æ—Ç –≤–∞—Å –¥–æ –∏–≥—Ä–æ–∫–æ–≤)",
    CurrentValue = false,
    Callback = function(Value)
        CheatConfig.ESP.Tracers = Value
        if not Value then
            for player, tracer in pairs(TracerObjects) do
                if tracer then tracer:Destroy() end
            end
            TracerObjects = {}
        else
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= LocalPlayer then
                    CreateTracer(player)
                end
            end
        end
    end
})

local MoveSection = MainTab:CreateSection("üöÄ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–ª–µ—Ç")
MainTab:CreateToggle({
    Name = "üïäÔ∏è –í–∫–ª—é—á–∏—Ç—å –ø–æ–ª–µ—Ç (WASD + Space/Shift)",
    CurrentValue = false,
    Callback = function(Value)
        CheatConfig.Fly.Enabled = Value
        ToggleFly()
    end
})

MainTab:CreateSlider({
    Name = "üí® –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª–µ—Ç–∞",
    Range = {10, 100},
    Increment = 5,
    Suffix = "speed",
    CurrentValue = 50,
    Callback = function(Value)
        CheatConfig.Fly.Speed = Value
    end
})

-- –£—Ç–∏–ª–∏—Ç—ã (–æ—Å—Ç–∞–≤–ª—è–µ–º)
local UtilSection = MainTab:CreateSection("üîß –£—Ç–∏–ª–∏—Ç—ã")
MainTab:CreateButton({
    Name = "üî´ –í–∑—è—Ç—å –ø—É—à–∫—É",
    Callback = function()
        local gun = Workspace:FindFirstChild("GunDrop")
        if gun then
            LocalPlayer.Character.HumanoidRootPart.CFrame = gun.CFrame
        end
    end
})

MainTab:CreateButton({
    Name = "üíÄ Kill All",
    Callback = function()
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                LocalPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
                wait(0.2)
            end
        end
    end
})

-- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–±–µ–∑ —Ç–∞–π–º–µ—Ä–æ–≤ –∏ –ê–§–ö!)
RunService.Heartbeat:Connect(function()
    if CheatConfig.ESP.Enabled then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                if not ESPObjects[player] then
                    RefreshPlayerESP(player)
                end
            end
        end
        UpdateESP()
    end

    if CheatConfig.ESP.Tracers then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                if not TracerObjects[player] then
                    CreateTracer(player)
                end
            end
        end
        UpdateTracers()
    end
end)

-- ESP –Ω–µ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç: —Å–ª–µ–¥–∏–º –∑–∞ –Ω–æ–≤—ã–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —É –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
SetupAllESP()

Rayfield:Notify({
    Title = "üî• MM2 ULTIMATE v6.1 –ó–ê–ì–†–£–ñ–ï–ù!",
    Content = "ESP –Ω–µ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç, —Ç—Ä–µ–π—Å–µ—Ä—ã –æ–±—ã—á–Ω—ã–µ, —Ç–∞–π–º–µ—Ä –∏ –ê–§–ö —É–±—Ä–∞–Ω—ã!",
    Duration = 6,
})

print([[
üî• MM2 ULTIMATE v6.1 –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!
‚úÖ ESP —Å —Ü–≤–µ—Ç–∞–º–∏ –ø–æ —Ä–æ–ª—è–º (–Ω–µ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç)
‚úÖ –û–±—ã—á–Ω—ã–µ —Ç—Ä–µ–π—Å–µ—Ä—ã (–æ—Ç –≤–∞—Å –¥–æ –∏–≥—Ä–æ–∫–æ–≤)
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–ª–µ—Ç
‚úÖ –¢–∞–π–º–µ—Ä –∏ –ê–§–ö —É–±—Ä–∞–Ω—ã!
]])
